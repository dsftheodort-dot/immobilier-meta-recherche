<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MÃ©ta-recherche Immo | Style Porsche</title>
  <style>
    body {
      font-family: "Helvetica Neue", Arial, sans-serif;
      background-color: #000;
      color: #f5f5f5;
      margin: 0;
      padding: 0;
    }
    header {
      background: #111;
      padding: 20px;
      text-align: center;
      border-bottom: 2px solid #b71c1c; /* rouge Porsche */
    }
    header h1 {
      font-size: 1.8rem;
      font-weight: 600;
      letter-spacing: 2px;
      color: #fff;
      margin: 0;
      text-transform: uppercase;
    }
    main {
      max-width: 700px;
      margin: 40px auto;
      padding: 20px;
    }
    label {
      display: block;
      margin-top: 20px;
      font-weight: 500;
      color: #ccc;
    }
    input, select {
      width: 100%;
      padding: 12px;
      margin-top: 8px;
      border: 1px solid #333;
      border-radius: 6px;
      background: #111;
      color: #f5f5f5;
      font-size: 1rem;
    }
    input:focus, select:focus {
      border-color: #b71c1c;
      outline: none;
    }
    button {
      margin-top: 30px;
      padding: 14px 24px;
      background: #b71c1c;
      color: #fff;
      font-size: 1.1rem;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      transition: 0.3s ease;
      letter-spacing: 1px;
      text-transform: uppercase;
    }
    button:hover {
      background: #d32f2f;
      transform: scale(1.05);
    }
    .results {
      margin-top: 40px;
      padding: 20px;
      background: #111;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(255,255,255,0.05);
    }
    .results h2 {
      color: #b71c1c;
      margin-bottom: 15px;
      font-size: 1.3rem;
      border-bottom: 1px solid #333;
      padding-bottom: 10px;
    }
    a {
      display: block;
      margin: 10px 0;
      color: #f5f5f5;
      text-decoration: none;
      padding: 10px;
      border-radius: 6px;
      transition: background 0.3s ease;
      border: 1px solid transparent;
    }
    a:hover {
      background: #b71c1c;
      border-color: #b71c1c;
    }
  </style>
</head>
<body>
  <header>
    <h1>MÃ©ta-recherche Immo</h1>
  </header>
  <main>
    <form id="form">
      <label>Ville (ex. Paris ou Lyon)<input id="city" required /></label>
      <label>Budget max (â‚¬)<input id="budget" type="number" min="0" step="1000" required /></label>
      <label>Type de bien</label>
      <select id="type">
        <option value="">IndiffÃ©rent</option>
        <option value="maison">Maison</option>
        <option value="appartement">Appartement</option>
        <option value="terrain">Terrain</option>
      </select>
      <label>Mots-clÃ©s (facultatif, ex. non louÃ©, travaux)<input id="keywords" /></label>
      <button type="submit">Lancer la recherche</button>
    </form>
    <div class="results" id="results" hidden>
      <h2>RÃ©sultats :</h2>
      <div id="links"></div>
    </div>
  </main>
<script>
function normalizeCity(c){return c.trim().replace(/\s+/g,"_");}
function googleLink(domain, query){ return `https://www.google.com/search?q=site:${domain}+${encodeURIComponent(query)}`; }
function testLink(url, onSuccess, onFail) {
  fetch(url, { method: 'HEAD', mode:'no-cors' }).then(()=> onSuccess()).catch(()=> onFail());
}

document.getElementById("form").addEventListener("submit", e=>{
  e.preventDefault();
  const city = document.getElementById("city").value.trim();
  const budget = document.getElementById("budget").value.trim();
  const type = document.getElementById("type").value;
  const kw = document.getElementById("keywords").value.trim();
  const cityParam = normalizeCity(city);
  const query = `${city} ${kw}`.trim();

  const linksDiv = document.getElementById("links");
  linksDiv.innerHTML = "";

  const sites = [
    {
      name:"Le Bon Coin",
      tryUrl: `https://www.leboncoin.fr/recherche?category=9&locations=${encodeURIComponent(cityParam)}&price=0-${budget}${type==='maison'?'&real_estate_type=1':type==='appartement'?'&real_estate_type=2':type==='terrain'?'&real_estate_type=3':''}&text=${encodeURIComponent(kw)}`,
      domain:"leboncoin.fr"
    },
    {
      name:"SeLoger",
      tryUrl: `https://www.seloger.com/list.htm?prix=${budget}${type==='appartement'?'&types=1':type==='maison'?'&types=2':''}&q=${encodeURIComponent(query)}`,
      domain:"seloger.com"
    },
    {
      name:"Bienâ€™ici",
      tryUrl: `https://www.bienici.com/recherche/achat?price-max=${budget}&text=${encodeURIComponent(query)}${type==='appartement'?'&propertyType=apartment':type==='maison'?'&propertyType=house':type==='terrain'?'&propertyType=land':''}`,
      domain:"bienici.com"
    },
    {
      name:"PAP",
      tryUrl: `https://www.pap.fr/annonce/vente-immobilier-${encodeURIComponent(cityParam)}-r${budget}${kw?`?q=${encodeURIComponent(kw)}`:''}`,
      domain:"pap.fr"
    }
  ];

  sites.forEach(s=>{
    testLink(s.tryUrl,
      ()=> linksDiv.innerHTML += `<a href="${s.tryUrl}" target="_blank">ðŸ”— ${s.name} (direct)</a>`,
      ()=> linksDiv.innerHTML += `<a href="${googleLink(s.domain, query+' '+budget)}" target="_blank">ðŸ”Ž ${s.name} (via Google)</a>`
    );
  });

  document.getElementById("results").hidden = false;
});
</script>
</body>
</html>
